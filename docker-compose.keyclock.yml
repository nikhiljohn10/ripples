version: '3.9'

services:
  keycloak:
    build: 
      context: dockerfiles
      dockerfile: keycloak.dockerfile
    image: keycloak:local
    container_name: keycloak
    command: >
      start
        --optimized
        --https-port=8443
        --hostname=localhost
        --https-key-store-file=/opt/keycloak/conf/server.keystore
        --https-key-store-password=KeyCloakPassW0rd
    environment:
      KC_DB_USERNAME: admin
      KC_DB_PASSWORD: Postgres1234
      KC_DB_URL: jdbc:postgresql://postgres:5432/keycloak
      KEYCLOAK_ADMIN: admin
      KEYCLOAK_ADMIN_PASSWORD: Keycloak@123
    ports:
      - 8443:8443
    networks:
      - docker-networks

networks:
  docker-networks:
    name: docker-networks